--insert tabella libro
insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('alessandro manzoni', 'i promessi sposi', 700, 'un classico della letteratura italiana che narra le vicende di renzo e lucia.', 'https://imgs.search.brave.com/zlqbotlnvag1l0sdwt1iu0jhsmwkszvfjs0ircxcixm/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/njf1r2vvntfqzewu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('George Orwell', '1984', 328, 'Un romanzo distopico che descrive una società totalitaria.', 'https://imgs.search.brave.com/wdkyfmkrgdjy2hgesvfkqvk_4_m4aj14yoi-0x210uc/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/ntfvqwhrzthwskwu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Jane Austen', 'Orgoglio e Pregiudizio', 432, 'Una storia d''amore e costumi nella società inglese del xix secolo.', 'https://imgs.search.brave.com/n0zi-ohlhz7_qjha2p4qs7vqzh2bqs4xvnrzqdalrx8/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/njfsyxiyzji4oewu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Antoine De Saint-Exupéry', 'Il piccolo principe', 96, 'Un''opera poetica e filosofica che tocca temi universali.', 'https://imgs.search.brave.com/0ltkeab3ioworm83_brxejz5hovzd7ex0l0pv93bbhu/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/ntfuc01ulwotzuwu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Umberto Eco', 'Il nome della rosa', 544, 'Un thriller storico-filosofico ambientato in un monastero medievale.', 'https://imgs.search.brave.com/inq9oadrx6xbj-r7vlrbwifouxwd4lzxuiupjwjvh2c/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9wawn0/dxjlcy5hymvib29r/cy5jb20vaw52zw50/b3j5l21kl21kmze1/nti0mzgznzguanbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('J.K. Rowling', 'Harry Potter e la Pietra Filosofale', 223, 'Il primo libro della celebre saga di Harry Potter.', 'https://imgs.search.brave.com/focqr6wte0hxe6eoebm1imedgof4hecomvwmu0tlnak/rs:fit:500:0:0:0/g:ce/ahr0chm6ly93d3cu/ywrhemluzy5jb20v/d3aty29udgvudc91/cgxvywrzlziwmjiv/mtivsgfycnktug90/dgvylujvb2stq292/zxjzlunoyw1izxit/b2ytu2vjcmv0cy11/cy0xlty4mngxmdi0/lnbuzw');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Stephen King', 'It', 1138, 'Un romanzo horror che segue le vicende di un gruppo di amici contro una malvagia entità.', 'https://imgs.search.brave.com/zrb1o0gs_gwo2rl_c7wmje_wu07op_uvsqtizpkpdby/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/ndfhq3nlwwved0wu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Gabriel Garcia Marquez', 'Cent''anni di solitudine', 448, 'Un capolavoro del realismo magico che narra la saga della famiglia buendía.', 'https://imgs.search.brave.com/sbqnkfoadjik3j_vga53tdg3hvcgegzjzdfjuj0nkj8/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9wawn0/dxjlcy5hymvib29r/cy5jb20vaw52zw50/b3j5l21kl21kmzex/mtcxnjqynjauanbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Dante Alighieri', 'Divina commedia', 500, 'Un poema allegorico che descrive il viaggio di dante attraverso inferno, purgatorio e paradiso.', 'https://imgs.search.brave.com/jtkviewxagapveraibbw45dmtk5bpwnffc61vsfk7yo/rs:fit:500:0:0:0/g:ce/ahr0chm6ly9tlm1l/zglhlwftyxpvbi5j/b20vaw1hz2vzl0kv/ode3vkc2n1fvqkwu/anbn');

insert into public.books (autore, titolo, pagine, descrizione, immagine)
values ('Agatha Christie', 'Dieci piccoli indiani', 256, 'Un celebre romanzo giallo con un mistero da risolvere su un''isola isolata.', 'https://imgs.search.brave.com/05yxSkidetV6VgBo96QIsMhwI7P4PjK-FOacWLmwL6Q/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NDFIUlFIaEduTEwu/anBn');


--INSERT TABELLA BOOK
INSERT INTO book (autore, titolo, pagine, descrizione, copertina) 
VALUES
('J.W. Gothe', 'I dolori del giovane Werther', 1774, 'La tragica vita e dolorosa vita di un giovane artista tedesco.', 'https://imgs.search.brave.com/PIg26x8Z2XQfTEXZjQz2L-T21_OaIbdXbOi7AbK6Y3I/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9naXVu/dGkuaXQvY2RuL3No/b3AvcHJvZHVjdHMv/MDdhNTdkZjU5MTM5/NGJjMzg5OGExNjZh/YjY3NzE3YmY1OTM1/MUUuanBnP3Y9MTc0/MjgyODUzNyZ3aWR0/aD0xNDQ1'),
('Dan Brown', 'Il Codice Da Vinci', 592, 'Un thriller con misteri storici e artistici.', 'https://imgs.search.brave.com/GkBT23dAGhH2xh9_kR0TexLXOOFo_SEZ9Vwr6gRcSYI/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NzE0UWd0SGNlckwu/anBn'),
('Stephenie Meyer', 'Twilight', 498, 'Un romanzo fantasy-romance sui vampiri.', 'https://imgs.search.brave.com/_e6ZUrqHrYnDsOeeukrixPeDYbf_V1cSonvv6T0Vl34/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NDExMUdqelVxVkwu/anBn'),
('Suzanne Collins', 'Hunger Games', 374, 'Un distopico d''azione per giovani adulti.', 'https://imgs.search.brave.com/muanQZFhD3TeRo3J37PqvIXlMINaPf9_aO6E8BrBgD4/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NTFhLXR1bHBWdUwu/anBn'),
('Stieg Larsson', 'Uomini che odiano le donne', 672, 'Il primo volume della trilogia Millennium.', 'https://imgs.search.brave.com/01rzBMnUUKlAC_RNxEE_zIy6_0txvJtEF9BtL4DjvxA/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/OTFyQzZWRWx3dkwu/anBn'),
('Ken Follett', 'I Pilastri della Terra', 1008, 'Un''epopea storica ambientata nel Medioevo.', 'https://imgs.search.brave.com/zEYuVAGNSmtZfzE1cEG4jA88V9OPQFAbdIXmx1ZjDT8/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly90YS1k/YS5pdC9jZG4vc2hv/cC9wcm9kdWN0cy85/Nzg4ODA0NzA3MDM1/XzBfMjMwXzM1MF8w/XzlhNzE0MDk4LThk/ZWItNGFlOS1iMmNh/LTgzNmE5ZDU1MjAx/YS5qcGc_dj0xNjA1/MDQzNDk4JndpZHRo/PTE0NDU'),
('Yuval Noah Harari', 'Sapiens: Da animali a dèi', 520, 'Una breve storia del genere umano.', 'https://imgs.search.brave.com/FkqoVCNEJpYzM8TThie_ZP2EOLnW7nWD8SqBGrhmr0c/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly93d3cu/aWJzLml0L2ltYWdl/cy85Nzg4ODQ1Mjk2/NDk5XzBfMF81MzZf/MF83NS5qcGc'),
('Michelle Obama', 'Becoming', 448, 'Le memorie dell''ex First Lady degli Stati Uniti.', 'https://imgs.search.brave.com/FmNfSxwUsuyVcROtK8Dwdsb0Bseed-vBFsRDT6FPTWo/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9odHRw/Mi5tbHN0YXRpYy5j/b20vRF9OUV9OUF82/NzUyNzgtTUxBMjc0/ODYzMDAwMTRfMDYy/MDE4LU8ud2VicA'),
('Tara Westover', 'Educated', 334, 'Una straordinaria storia di auto-scoperta.', 'https://imgs.search.brave.com/PgjBdYJJIDwf2yW9xZm5lknrW3to3-WPwc3xC2EXjTA/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9pbWFn/ZXMuY2RuMy5idXNj/YWxpYnJlLmNvbS9m/aXQtaW4vMzYweDM2/MC8zNy8zYS8zNzNh/Y2MzOTE0MWYyMjIz/ZWZkNTQzMzk5MGQ4/ZTljZC5qcGc'),
('Delia Owens', 'La ragazza della palude', 384, 'Un mistero e un racconto di formazione.', 'https://imgs.search.brave.com/5d--YFWdctsZoQgxUgw4VBXuaWW0f5ZKv3FXSABFQPo/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL00v/TVY1QlpHTTVPRFU1/WVRrdE1HVXhZaTAw/WWpReUxUazBNemd0/WlRnME1XUTJORGcw/WVRBMFhrRXlYa0Zx/Y0djQC5qcGc'),
('Colleen Hoover', 'It Ends with Us', 376, 'Un toccante romanzo contemporaneo.', 'https://imgs.search.brave.com/zEKCbDp8w2UBORsiIsfRyk_1qvLqNz4dzfh2-ovHi7k/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9odHRw/Mi5tbHN0YXRpYy5j/b20vRF9RX05QXzJY/Xzk2Nzk3OC1NTEE0/OTcwNzE2NjczOV8w/NDIwMjItVi53ZWJw'),
('Britney Spears', 'The Woman in Me', 288, 'Le memorie della pop star.', 'https://imgs.search.brave.com/swDvLpT3kvcRhCSFW0ufKunC4k54uvRvlO1Zg4UrI24/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NDFIVGN5WlNSakwu/anBn'),
('James Clear', 'Atomic Habits', 320, 'Un libro sui piccoli cambiamenti per grandi risultati.', 'https://imgs.search.brave.com/6F1zvgZWppaQoX5mjqwZALYP9ZzZQjv6-NrujguKtUM/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9odHRw/Mi5tbHN0YXRpYy5j/b20vRF9RX05QXzJY/Xzg5MjAwOC1DQlQ2/OTExOTU2NzEzM18w/NDIwMjMtVi53ZWJw'),
('Matt Haig', 'La biblioteca di mezzanotte', 304, 'Un romanzo sulla possibilità di cambiare vita.', 'https://imgs.search.brave.com/jUAeTeDIBVLWgeb3VvbBSdTy-E1RamLirrwRxKs9v0Q/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NTFLTGhBZTlYbkwu/anBn'),
('George R.R. Martin', 'Il Trono di Spade', 694, 'Il primo volume della saga fantasy Le Cronache del Ghiaccio e del Fuoco.', 'https://imgs.search.brave.com/qZn_WPkQX3t8vKl2LNDgg0_xyWRYNdTtvTAy8DrNdUc/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9oaXBz/LmhlYXJzdGFwcHMu/Y29tL3ZhZGVyLXBy/b2QuczMuYW1hem9u/YXdzLmNvbS8xNjk5/ODg2NjU4LTgxZHJX/Nm11MUFMLmpwZz9j/cm9wPTF4dzoxeGg7/Y2VudGVyLHRvcCZy/ZXNpemU9OTgwOio'),
('Anthony Doerr', 'Tutta la luce che non vediamo', 544, 'Un romanzo storico ambientato durante la Seconda Guerra Mondiale.', 'https://imgs.search.brave.com/vTDn8eY8czVt78LMDg02tDklN4sa7qGXEKBaCZXScrQ/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NTFWbE5hbXJRQUwu/anBn'),
('Paula Hawkins', 'La ragazza del treno', 320, 'Un thriller psicologico avvincente.', 'https://imgs.search.brave.com/Mti9hZNvGLmcOA8BjpZPRBkiAjnmOSSN5FrKRXHt44I/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tLm1l/ZGlhLWFtYXpvbi5j/b20vaW1hZ2VzL0kv/NTFBRXZnLTdrR0wu/anBn'),
('Gillian Flynn', 'L''amore bugiardo', 432, 'Un romanzo ricco di suspense e colpi di scena.', 'https://imgs.search.brave.com/spJ-4Q55Bsjg7BKn6JkRE-jK5TaP8DJjXEw6yNkFqiM/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly93d3cu/bGlicmFjY2lvLml0/L2ltYWdlcy85Nzg4/ODE3MDg4NDU5XzBf/MzUwXzBfNzUuanBn'),
('Elena Ferrante', 'L''amica geniale', 336, 'Il primo volume della saga napoletana.', 'https://imgs.search.brave.com/DZg_x-obXc76zxFg-ia8NFaQL8OqE6fa-BhmxvLEeEg/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly93d3cu/bGFjZW50cmFsLmNv/bS9hdHJpbC85Nzg4/ODY2MzI0MTE5Lmpw/Zw'),
('Roberto Saviano', 'Gomorra', 336, 'Un''inchiesta sulla criminalità organizzata in Campania.', 'https://imgs.search.brave.com/gu58kDSgieiMuTgKXrfTIab5C__tpaRploRm_pSPY6g/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9odHRw/Mi5tbHN0YXRpYy5j/b20vRF9OUV9OUF83/MTQ5MzgtTUxVNTE3/NjkyMTM3MTVfMDky/MDIyLU8ud2VicA');


--INSERT TABELLA GENERE
insert into genere (nome_genere)
values 
('Romanzo'),
('Fantasy'),
('Sci-fi'),
('Thriller'),
('Horror'),
('Giallo'),
('Storico'),
('Biografia'),
('Saggio'),
('Poesia');


--INSERT TABELLA UTENTE
insert into utente (username, email, "password")
values 
('test1', 'test1@example.com', 'test1'),
('test2', 'test2@example.com', 'test2'),
('test3', 'test3@example.com', 'test3');


/*Se gli id si sfanculano e non partono da 1
-- 1. Rimuovi temporaneamente il vincolo PRIMARY KEY
-- Questo ci permette di modificare la colonna id_libro
ALTER TABLE public.utente DROP CONSTRAINT utente_pk CASCADE;

-- 2. Rinumera gli ID esistenti
-- Utilizza una Common Table Expression (CTE) e una funzione di finestra (ROW_NUMBER)
-- per assegnare nuovi ID sequenziali.
-- L'ordine qui è arbitrario (ORDER BY id_libro ASC), ma potresti voler ordinare
-- i tuoi libri in base a un altro criterio (es. titolo, autore) per determinare l'ordine dei nuovi ID.
WITH RankedUtente AS (
    SELECT
        id_utente,
        ROW_NUMBER() OVER (ORDER BY id_utente ASC) AS new_id_utente -- Ordina per l'ID originale per mantenere un ordine consistente
    FROM
        public.utente
)
UPDATE public.utente b
SET id_utente = rb.new_id_utente
FROM RankedUtente rb
WHERE b.id_utente = rb.id_utente;

-- 3. Riapplica il vincolo PRIMARY KEY
-- Assicurati che non ci siano duplicati dopo l'aggiornamento, altrimenti fallirà.
-- (ROW_NUMBER() garantisce l'unicità in questo caso)
ALTER TABLE public.utente ADD CONSTRAINT utente_pk PRIMARY KEY (id_utente);

-- 4. Resetta la sequenza 'libro_id_libro_seq' al nuovo valore massimo di id_libro
-- Questo assicura che i prossimi INSERT useranno ID progressivi dopo l'ultimo ID rinumerato.
SELECT setval('utente_id_utente_seq', (SELECT MAX(id_utente) FROM public.utente));

-- Oppure, se vuoi che il prossimo ID sia esattamente il MAX(id_libro) + 1, usa:
-- SELECT setval('libro_id_libro_seq', (SELECT MAX(id_libro) FROM public.books), false);
-- Il parametro 'false' indica che il valore fornito non è stato ancora "chiamato" dalla sequenza.
-- In questo caso, il prossimo nextval() restituirà MAX(id_libro) + 1.
-- Per sicurezza, `SELECT setval('libro_id_libro_seq', (SELECT MAX(id_libro) FROM public.books))` è spesso preferibile
-- perché imposta il "prossimo valore disponibile" al valore fornito.
-- Ad esempio, se MAX(id_libro) è 20, setval(..., 20) fa sì che il prossimo nextval() generi 21.
*/






